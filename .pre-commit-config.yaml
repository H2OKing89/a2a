# Pre-commit hooks for code quality and consistency
# Install: pip install pre-commit
# Setup: pre-commit install
# Run manually: pre-commit run --all-files

repos:
  # Basic file cleanup
- repo: https://github.com/pre-commit/pre-commit-hooks
  rev: v6.0.0
  hooks:
  - id: trailing-whitespace
    args: [--markdown-linebreak-ext=md]
  - id: end-of-file-fixer
  - id: check-yaml
  - id: check-json
  - id: check-toml
  - id: check-added-large-files
    args: [--maxkb=1000]
  - id: check-merge-conflict
  - id: check-case-conflict
  - id: detect-private-key
  - id: mixed-line-ending
    args: [--fix=lf]
  - id: check-docstring-first
  - id: check-ast
  - id: debug-statements
  - id: name-tests-test
    args: [--pytest-test-first]
    exclude: ^tests/(conftest|__init__)\.py$

  # Python code formatting
- repo: https://github.com/psf/black
  rev: 25.12.0
  hooks:
  - id: black
    language_version: python3
    args: [--line-length=120]

  # Import sorting
- repo: https://github.com/PyCQA/isort
  rev: 7.0.0
  hooks:
  - id: isort
    args: [--profile=black, --line-length=120]

  # Upgrade Python syntax
- repo: https://github.com/asottile/pyupgrade
  rev: v3.21.2
  hooks:
  - id: pyupgrade
    args: [--py313-plus]

  # Linting
- repo: https://github.com/PyCQA/flake8
  rev: 7.3.0
  hooks:
  - id: flake8
    args:
    - --max-line-length=120
    - --extend-ignore=E203,W503,E501,E402,F401,F841,B008,F541,B042,SIM105,SIM113,SIM116,SIM118
    - --exclude=.git,__pycache__,.venv,.eggs,*.egg,build,dist
    additional_dependencies:
    - flake8-bugbear
    - flake8-comprehensions
    - flake8-simplify

  # Security checks
- repo: https://github.com/PyCQA/bandit
  rev: 1.9.2
  hooks:
  - id: bandit
    args:
    - -c
    - pyproject.toml
    - --skip=B110,B112,B324
    additional_dependencies: ['bandit[toml]']
    exclude: ^tests/

  # Type checking with mypy (disabled - needs type hint improvements)
  # - repo: https://github.com/pre-commit/mirrors-mypy
  #   rev: v1.19.1
  #   hooks:
  #     - id: mypy
  #       args: [--ignore-missing-imports, --warn-unused-ignores]
  #       additional_dependencies:
  #         - types-PyYAML
  #         - types-toml
  #         - pydantic
  #       exclude: ^tests/

  # Docstring coverage and format (disabled - needs docstring improvements)
  # - repo: https://github.com/PyCQA/pydocstyle
  #   rev: 6.3.0
  #   hooks:
  #     - id: pydocstyle
  #       args: [--convention=google, --add-ignore=D100,D104,D105,D107]
  #       exclude: ^tests/

  # YAML formatting
- repo: https://github.com/macisamuele/language-formatters-pre-commit-hooks
  rev: v2.15.0
  hooks:
  - id: pretty-format-yaml
    args: [--autofix, --indent=2]

  # Spell checking (markdown and code comments)
- repo: https://github.com/codespell-project/codespell
  rev: v2.4.1
  hooks:
  - id: codespell
    args:
    - --ignore-words-list=crate,nd,sav,wil,AIN,MINA,tha,wan,revered,UPTODATE
    - --skip="*.json,*.yaml,*.lock,htmlcov,*.db"
    exclude: ^(.*\.json|.*\.yaml|.*\.lock|htmlcov/.*|.*\.db)$

  # pytest (optional - runs tests before commit)
  # Uncomment to enable automatic test running
  # - repo: local
  #   hooks:
  #     - id: pytest-check
  #       name: pytest
  #       entry: pytest
  #       language: system
  #       pass_filenames: false
  #       always_run: true
  #       args: [tests/, -v, --tb=short]

# CI=true will skip some hooks in CI environments
ci:
  autofix_commit_msg: |
    [pre-commit.ci] auto fixes from pre-commit.com hooks

    for more information, see https://pre-commit.ci
  autofix_prs: true
  autoupdate_branch: ''
  autoupdate_commit_msg: '[pre-commit.ci] pre-commit autoupdate'
  autoupdate_schedule: weekly
  skip: []
  submodules: false
